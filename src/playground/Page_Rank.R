####################################################################################
####################################################################################
### PageRank, primeiro exemplo.
####################################################################################
####################################################################################

# Limpando o console.
cat("\014") 
# Limpando o Global Environment.
rm(list = ls())

####################################################################################
### Importar bibliotecas de uso.
####################################################################################

library(igraph)

####################################################################################
### Construir grafo e Matriz de Adjac?ncia Estoc?stica Transposta.
####################################################################################

g <- graph(c(1, 2, 1, 3, 2, 3, 2, 4, 3, 2, 4, 1, 4, 2, 4, 3), directed = TRUE)

plot(g)

M = get.adjacency(g, sparse  =  FALSE)
Mt = t(M / rowSums(M))
n = nrow(Mt)

####################################################################################
### Resolver o problema por itera??es de c?lculo matricial.
####################################################################################

v = matrix(data = rep(1 / n, n), nrow = n, ncol = 1)

Mt %*% v
Mt %*% (Mt %*% v)
Mt %*% (Mt %*% (Mt %*% v))
Mt %*% (Mt %*% (Mt %*% (Mt %*% v)))
Mt %*% (Mt %*% (Mt %*% (Mt %*% (Mt %*% v))))
Mt %*% (Mt %*% (Mt %*% (Mt %*% (Mt %*% (Mt %*% v)))))
Mt %*% (Mt %*% (Mt %*% (Mt %*% (Mt %*% (Mt %*% (Mt %*% v))))))

####################################################################################
### Resolver o problema por teoria de Autovalores e Autovetores.
####################################################################################

e = eigen(Mt)
r <- e$vec[ , 1]
r <- as.numeric(r) / sum(as.numeric(r))

r
